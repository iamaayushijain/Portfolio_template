{"version":3,"file":"index.js","sources":["../../../../components/Calendar/index.tsx"],"sourcesContent":["import React from 'react';\nimport { DayPicker, isDateAfterType, isDateBeforeType, Matcher, Modifier } from 'react-day-picker';\nimport some from 'lodash/some';\nimport isArray from 'lodash/isArray';\nimport map from 'lodash/map';\nimport get from 'lodash/get';\nimport findIndex from 'lodash/findIndex';\nimport castArray from 'lodash/castArray';\nimport { endOfDay, isAfter, isBefore, isSameDay, startOfDay } from 'date-fns';\nimport styles from './index.module.scss';\n\nexport type DateIsh = Date | string | number;\n\nfunction throwError(message: string): void {\n    throw new Error(`TUI DatePicker: ${message}`);\n}\n\nexport function normaliseValue(value: CalendarProps['value']): Date[] {\n    if (!value) {\n        return [];\n    }\n\n    if (!isArray(value)) {\n        return [new Date(value)];\n    }\n\n    return map(value, d => new Date(d));\n}\n\n// Returns true any of the given `dates` fall on a day before the day of `cutoff`.\nexport function hasAnyPastDays(dates: Date[], cutoff: Date = new Date()): boolean {\n    return some(dates, date => isBefore(endOfDay(date), cutoff));\n}\n\n// Returns true any of the given `dates` fall on a day after the day of `cutoff`.\nexport function hasAnyFutureDays(dates: Date[], cutoff: Date = new Date()): boolean {\n    return some(dates, date => isAfter(startOfDay(date), cutoff));\n}\n\nexport function validateProps(props: CalendarProps): void {\n    const days = normaliseValue(props.value);\n\n    if (!props.allowMultiSelection && days.length > 1) {\n        throwError('`allowMultiSelection` is `false` but multiple dates were provided');\n    }\n\n    const disabledDays = castArray(props.disabledDays);\n\n    /* eslint-disable lodash/prefer-lodash-method */\n    disabledDays.forEach(modifier => {\n        if (isDateBeforeType(modifier) && hasAnyPastDays(days, modifier.before)) {\n            throwError(\n                `Days before ${modifier.before} are disabled but one or more provided days fall before that.`,\n            );\n        }\n    });\n\n    disabledDays.forEach(modifier => {\n        if (isDateAfterType(modifier) && hasAnyFutureDays(days, modifier.after)) {\n            throwError(\n                `Days after ${modifier.after} are disabled but one or more provided days fall after that.`,\n            );\n        }\n    });\n}\n\nexport interface CalendarProps {\n    /**\n     * One or more dates to show as selected in the initial UI. Each \"date\" can be a JS Date object\n     * or a string representing a date, or a numeric UNIX timestamp, and either a single object or\n     * an array of such objects can be provided.\n     */\n    value?: DateIsh | DateIsh[] | null;\n    /**\n     * Date object representing the month that is currently displayed by the calendar. If omitted\n     * it will default to the first date in the `value` prop. You should update it in response to\n     * the `onMonthChange` prop.\n     */\n    month?: Date;\n    /**\n     * Callback that is triggered when th user selects a date. The function receives an array of\n     * a JavaScript Date objects for each of the currently selected dates.\n     */\n    onChange: (selectedDates: Date[]) => void;\n    /**\n     * Callback that is triggered when the user navigates to a different month using the navigation\n     * buttons or keyboard. The function receives a single JavaScript `Date` object indicating\n     * the new on-screen month.\n     */\n    onMonthChange: (selectedMonth: Date) => void;\n    /**\n     * Boolean that determines whether or not the user is allowed to select more than one date at\n     * a time. Defaults to `false`.\n     */\n    allowMultiSelection?: boolean;\n    /**\n     * A react-day-picker modifier for greater control over disabled days. Past selection is\n     * disabled by default.\n     * See: https://react-day-picker.js.org/api/types/Matcher\n     */\n    disabledDays?: Matcher | Matcher[] | null;\n    /**\n     * A Date object representing the last allowed month. Users wonâ€™t be able to navigate or\n     * interact with the days after it.\n     */\n    lastMonth?: Date;\n    /**\n     * Applies a blue dot indicator below the numeric day in the calendar's day cell if the\n     * function returns `true` for a given JavaScript `Date`.\n     */\n    daysThemeDotIndicator?: (date: Date) => boolean;\n    /**\n     * Applies a strikeout treatment on the numeric day in the calendar's day cell if the function\n     * returns `true` for a given JavaScript `Date`.\n     */\n    daysThemeStrikeout?: (date: Date) => boolean;\n}\n\n/**\n * Thin wrapper around `react-day-picker` that renders a calendar.\n */\nexport default function Calendar({\n    value = [],\n    onChange,\n    onMonthChange,\n    disabledDays = { before: new Date() },\n    month,\n    lastMonth,\n    allowMultiSelection = false,\n    daysThemeDotIndicator,\n    daysThemeStrikeout,\n}: CalendarProps): JSX.Element {\n    validateProps({\n        value,\n        onChange,\n        disabledDays,\n        month,\n        lastMonth,\n        allowMultiSelection,\n        onMonthChange,\n        daysThemeDotIndicator,\n        daysThemeStrikeout,\n    });\n\n    const selectedDays = normaliseValue(value);\n\n    const modifiers: Record<string, Matcher> = {};\n    const modifiersClassNames: Record<Modifier, string> = {};\n\n    if (typeof daysThemeDotIndicator === 'function') {\n        modifiers['theme-dot'] = daysThemeDotIndicator;\n        modifiersClassNames['theme-dot'] = 'rdp-day--theme-dot';\n    }\n\n    if (typeof daysThemeStrikeout === 'function') {\n        modifiers['theme-strikeout'] = daysThemeStrikeout;\n        modifiersClassNames['theme-strikeout'] = 'rdp-day--theme-strikeout';\n    }\n\n    return (\n        <div className={styles.root}>\n            <DayPicker\n                disabled={disabledDays || undefined}\n                fromMonth={get(disabledDays, 'before', null)}\n                toMonth={lastMonth}\n                month={\n                    month ||\n                    (selectedDays && selectedDays.length > 0 ? selectedDays[0] : new Date())\n                }\n                selected={selectedDays}\n                onMonthChange={onMonthChange}\n                modifiers={modifiers}\n                modifiersClassNames={modifiersClassNames}\n                onDayClick={(day, { selected }): void => {\n                    let newSelectedDays = normaliseValue(value);\n\n                    if (allowMultiSelection) {\n                        if (selected) {\n                            const selectedIndex = findIndex(newSelectedDays, selectedDay =>\n                                isSameDay(selectedDay, day),\n                            );\n                            newSelectedDays.splice(selectedIndex, 1);\n                        } else {\n                            newSelectedDays.push(day);\n                        }\n                    } else {\n                        newSelectedDays = [day];\n                    }\n\n                    onChange(map(newSelectedDays, startOfDay));\n                }}\n            />\n        </div>\n    );\n}\n"],"names":["throwError","message","Error","normaliseValue","value","isArray","Date","map","d","hasAnyPastDays","dates","cutoff","some","date","isBefore","endOfDay","hasAnyFutureDays","isAfter","startOfDay","validateProps","props","days","allowMultiSelection","length","disabledDays","castArray","forEach","modifier","isDateBeforeType","before","isDateAfterType","after","Calendar","onChange","onMonthChange","month","lastMonth","daysThemeDotIndicator","daysThemeStrikeout","selectedDays","modifiers","modifiersClassNames","styles","root","undefined","get","day","selected","newSelectedDays","selectedIndex","findIndex","selectedDay","isSameDay","splice","push"],"mappings":"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"}